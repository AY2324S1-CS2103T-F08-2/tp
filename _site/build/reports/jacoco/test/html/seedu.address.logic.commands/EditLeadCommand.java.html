<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EditLeadCommand.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tp</a> &gt; <a href="index.source.html" class="el_package">seedu.address.logic.commands</a> &gt; <span class="el_source">EditLeadCommand.java</span></div><h1>EditLeadCommand.java</h1><pre class="source lang-java linenums">package seedu.address.logic.commands;

import static java.util.Objects.requireNonNull;
import static seedu.address.logic.parser.CliSyntax.PREFIX_ADDRESS;
import static seedu.address.logic.parser.CliSyntax.PREFIX_EMAIL;
import static seedu.address.logic.parser.CliSyntax.PREFIX_KEY_MILESTONE;
import static seedu.address.logic.parser.CliSyntax.PREFIX_MEETING_TIME;
import static seedu.address.logic.parser.CliSyntax.PREFIX_NAME;
import static seedu.address.logic.parser.CliSyntax.PREFIX_PHONE;
import static seedu.address.logic.parser.CliSyntax.PREFIX_TAG;
import static seedu.address.model.Model.PREDICATE_SHOW_ALL_PERSONS;

import java.util.List;
import java.util.Optional;
import java.util.Set;

import seedu.address.commons.core.index.Index;
import seedu.address.commons.util.ToStringBuilder;
import seedu.address.logic.Messages;
import seedu.address.logic.commands.exceptions.CommandException;
import seedu.address.model.Model;
import seedu.address.model.person.Address;
import seedu.address.model.person.Email;
import seedu.address.model.person.KeyMilestone;
import seedu.address.model.person.Lead;
import seedu.address.model.person.MeetingTime;
import seedu.address.model.person.Name;
import seedu.address.model.person.Person;
import seedu.address.model.person.Phone;
import seedu.address.model.tag.Tag;

/**
 * Edits the details of an existing lead in the address book.
 */
<span class="pc bpc" id="L35" title="1 of 2 branches missed.">public class EditLeadCommand extends EditCommand {</span>

    public static final String COMMAND_WORD = &quot;edit&quot;;
<span class="fc" id="L38">    public static final String MESSAGE_USAGE = COMMAND_WORD + &quot;: Edits the details of the person identified &quot;</span>
            + &quot;by the index number used in the displayed person list. &quot;
            + &quot;Existing values will be overwritten by the input values.\n&quot;
            + &quot;Parameters: INDEX (must be a positive integer) &quot;
            + &quot;[&quot; + PREFIX_NAME + &quot;NAME] &quot;
            + &quot;[&quot; + PREFIX_PHONE + &quot;PHONE] &quot;
            + &quot;[&quot; + PREFIX_EMAIL + &quot;EMAIL] &quot;
            + &quot;[&quot; + PREFIX_ADDRESS + &quot;ADDRESS] &quot;
            + &quot;[&quot; + PREFIX_KEY_MILESTONE + &quot;KEY_MILESTONE] &quot;
            + &quot;[&quot; + PREFIX_MEETING_TIME + &quot;MEETING_TIME] &quot;
            + &quot;[&quot; + PREFIX_TAG + &quot;TAG]...\n&quot;
            + &quot;Example: &quot; + COMMAND_WORD + &quot; 1 &quot;
            + PREFIX_PHONE + &quot;91234567 &quot;
            + PREFIX_EMAIL + &quot;johndoe@example.com&quot;;
    public static final String INVALID_USAGE_FOR_CLIENT = &quot;Type client has no key milestone.&quot;;


    private final Index index;
    private final EditLeadDescriptor editLeadDescriptor;

    /**
     * @param index                of the person in the filtered person list to edit
     * @param editLeadDescriptor details to edit the lead with
     */
    public EditLeadCommand(Index index, EditLeadDescriptor editLeadDescriptor) {
<span class="fc" id="L63">        super(index, editLeadDescriptor);</span>
<span class="fc" id="L64">        requireNonNull(index);</span>
<span class="fc" id="L65">        requireNonNull(editLeadDescriptor);</span>

<span class="fc" id="L67">        this.index = index;</span>
<span class="fc" id="L68">        this.editLeadDescriptor = new EditLeadDescriptor(editLeadDescriptor);</span>
<span class="fc" id="L69">    }</span>


    private static Lead createEditedLead(Lead leadToEdit, EditLeadDescriptor editLeadDescriptor) {
<span class="pc bpc" id="L73" title="2 of 4 branches missed.">        assert leadToEdit != null;</span>

<span class="fc" id="L75">        Name updatedName = editLeadDescriptor.getName().orElse(leadToEdit.getName());</span>
<span class="fc" id="L76">        Phone updatedPhone = editLeadDescriptor.getPhone().orElse(leadToEdit.getPhone());</span>
<span class="fc" id="L77">        Email updatedEmail = editLeadDescriptor.getEmail().orElse(leadToEdit.getEmail());</span>
<span class="fc" id="L78">        Address updatedAddress = editLeadDescriptor.getAddress().orElse(leadToEdit.getAddress());</span>
<span class="fc" id="L79">        Set&lt;Tag&gt; updatedTags = editLeadDescriptor.getTags().orElse(leadToEdit.getTags());</span>
<span class="fc" id="L80">        KeyMilestone updatedKeyMilestone = editLeadDescriptor.getKeyMilestone()</span>
<span class="fc" id="L81">                .orElse(leadToEdit.getKeyMilestone());</span>
<span class="fc" id="L82">        Optional&lt;MeetingTime&gt; updatedMeetingTime = editLeadDescriptor.getMeetingTime()</span>
<span class="fc" id="L83">                .or(leadToEdit::getMeetingTime);</span>

<span class="fc" id="L85">        return new Lead(updatedName, updatedPhone, updatedEmail, updatedAddress, updatedKeyMilestone,</span>
                updatedMeetingTime, updatedTags);
    }

    @Override
    public CommandResult execute(Model model) throws CommandException {
<span class="fc" id="L91">        requireNonNull(model);</span>
<span class="fc" id="L92">        List&lt;Person&gt; lastShownList = model.getFilteredPersonList();</span>

<span class="fc bfc" id="L94" title="All 2 branches covered.">        if (index.getZeroBased() &gt;= lastShownList.size()) {</span>
<span class="fc" id="L95">            throw new CommandException(Messages.MESSAGE_INVALID_PERSON_DISPLAYED_INDEX);</span>
        }
<span class="fc" id="L97">        Person personToEdit = lastShownList.get(index.getZeroBased());</span>
<span class="fc bfc" id="L98" title="All 2 branches covered.">        if (personToEdit.isClient()) {</span>
            //if &quot;edit index k/&quot; is used on client
<span class="fc" id="L100">            throw new CommandException(INVALID_USAGE_FOR_CLIENT);</span>
        }
<span class="pc bpc" id="L102" title="2 of 4 branches missed.">        assert(personToEdit.isLead());</span>
<span class="fc" id="L103">        Lead leadToEdit = (Lead) lastShownList.get(index.getZeroBased());</span>
<span class="fc" id="L104">        Lead editedLead = createEditedLead(leadToEdit, editLeadDescriptor);</span>

<span class="fc bfc" id="L106" title="All 4 branches covered.">        if (!leadToEdit.isSamePerson(editedLead) &amp;&amp; model.hasPerson(editedLead)) {</span>
<span class="fc" id="L107">            throw new CommandException(MESSAGE_DUPLICATE_PERSON);</span>
        }

<span class="fc" id="L110">        model.setPerson(leadToEdit, editedLead);</span>
<span class="fc" id="L111">        model.updateFilteredPersonList(PREDICATE_SHOW_ALL_PERSONS);</span>
<span class="fc" id="L112">        return new CommandResult(String.format(MESSAGE_EDIT_LEAD_SUCCESS, Messages.format(editedLead)));</span>
    }

    @Override
    public boolean equals(Object other) {
<span class="fc bfc" id="L117" title="All 2 branches covered.">        if (other == this) {</span>
<span class="fc" id="L118">            return true;</span>
        }

        // instanceof handles nulls
<span class="fc bfc" id="L122" title="All 2 branches covered.">        if (!(other instanceof EditLeadCommand)) {</span>
<span class="fc" id="L123">            return false;</span>
        }

<span class="fc" id="L126">        EditLeadCommand otherEditCommand = (EditLeadCommand) other;</span>
<span class="pc bpc" id="L127" title="1 of 2 branches missed.">        return index.equals(otherEditCommand.index)</span>
<span class="pc bpc" id="L128" title="1 of 2 branches missed.">                &amp;&amp; editLeadDescriptor.equals(otherEditCommand.editLeadDescriptor);</span>
    }

    @Override
    public String toString() {
<span class="fc" id="L133">        return new ToStringBuilder(this)</span>
<span class="fc" id="L134">                .add(&quot;index&quot;, index)</span>
<span class="fc" id="L135">                .add(&quot;editLeadDescriptor&quot;, editLeadDescriptor)</span>
<span class="fc" id="L136">                .toString();</span>
    }


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>